[pytest]
# Pytest configuration for Agent Cellphone V2 Repository
# Optimized for CI/CD performance and maintainability

# Test discovery patterns
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Exclude directories from test collection
norecursedirs = 
    .git
    .venv
    venv
    env
    __pycache__
    *.egg-info
    .pytest_cache
    .coverage
    build
    dist
    temp_repos
    archive
    consolidation_backups
    consolidation_logs
    dream
    trader_replay
    extensions
    tools_v2
    mcp_servers
    money_ops
    prompts
    quarantine
    repo_consolidation_groups
    reports
    schemas
    stress_test_analysis_results
    stress_test_results
    swarm_proposals
    systems
    thea_responses
    trading_robot

# Cache configuration for faster test discovery
cache_dir = .pytest_cache

# Parallel execution configuration (requires pytest-xdist)
# Use: pytest -n auto (auto-detect CPU count) or pytest -n 4 (4 workers)
# Note: Some tests may need to run sequentially (use pytest -n 0 to disable)

# Test execution options
# -v: verbose output
# -x: stop on first failure (can be overridden)
# --strict-markers: enforce marker registration
# --strict-config: enforce configuration validation
# --tb=short: shorter traceback format for CI/CD
# --durations=10: show 10 slowest tests
# --disable-warnings: suppress warnings for cleaner CI output
# --maxfail=1: stop after 1 failure (useful for quick feedback)
addopts = 
    -v
    --strict-markers
    --strict-config
    --tb=short
    --durations=10
    --disable-warnings
    --maxfail=5
    --color=yes

# Markers for test categorization and filtering
# Usage: pytest -m "unit" to run only unit tests
#        pytest -m "not slow" to skip slow tests
markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (require external dependencies)
    slow: Slow running tests (long execution time, typically over 1 second)
    skip: Tests that should be skipped
    ci: Tests that run in CI/CD pipeline
    local: Tests that only run locally
    network: Tests that require network access
    browser: Tests that require browser automation
    database: Tests that require database access
    github: Tests that interact with GitHub API
    discord: Tests that interact with Discord API
    mock: Tests that use extensive mocking

# Logging configuration
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Test timeout (requires pytest-timeout plugin)
# timeout = 300  # 5 minutes default timeout (uncomment if pytest-timeout installed)

# Coverage integration (if pytest-cov is installed)
# [tool:pytest] section can also be added to pyproject.toml for coverage config

